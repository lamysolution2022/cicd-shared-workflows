# 메시징 릴리스 운영/복구 플레이북 v1

- SubmissionId: `5262c6a5a9e14d66bd897fb88354be42`
- PlanId: `7009f4e7-03cd-49b1-bf4a-5a11b82716ec`
- 작성일: 2026-02-19
- 작성자: Platform Engineer (CI/CD Owner)

## 1) 실패 시 롤백 절차
1. 릴리스 태그 기준 직전 안정 태그 확인
2. 배포 중지 + 소비자 영향 공지(Coordinaton 채널)
3. 직전 안정 태그로 rollback 배포
4. 메시지 소비 상태 확인(backlog, error rate)
5. 복구 완료 선언 및 사후 분석 등록

## 2) 알림 기준
- 즉시 알림(High)
  - 호환성 게이트 실패
  - 직렬화 실패율 > 1%
  - DLQ 유입 급증(기준선 대비 2배)
- 경고(Warning)
  - 소비 지연 p95 20% 이상 증가
  - 재처리 큐 누적 건수 임계치 초과

## 3) 복구 플레이북
### P1. 호환성 게이트 실패
- 조치: 릴리스 차단 유지 -> 계약 diff 확인 -> SemVer 재판정
- 종료 조건: 게이트 green + 재검토 승인

### P2. 프로덕션 직렬화 오류
- 조치: 신규 퍼블리시 중단 -> 안정 버전 롤백 -> 실패 메시지 격리
- 종료 조건: 오류율 정상화 + 재처리 완료

### P3. 메시지 누락/중복 의심
- 조치: outbox/audit 로그 대조 -> 중복 제거 키 적용 -> 재처리
- 종료 조건: 누락 0건/중복 정책 충족

## 4) 잔여 리스크
- 다중 소비자 버전 혼재 시 edge-case 호환성 이슈 가능
- 대규모 배치 이벤트에서 순서 보장 정책 검증 추가 필요

## 5) 차기 액션
1. 소비자별 계약 버전 매트릭스 자동 수집
2. 릴리스 승인 봇(체크리스트 자동 검증) 추가
3. DLQ 재처리 플레이북 자동화 스크립트화

## 6) 운영 원칙
- Coordination 단일 채널
- Owner 직접 소통 금지
